function HueWheel(t,e){function n(t,e){var n=t.getBoundingClientRect();return Pt=T(e.touches[0]),{x:e.touches[0].clientX-n.left,y:e.touches[0].clientY-n.top}}function r(t,e){var n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}function o(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}function a(t,e){var n=t-it,r=e-st;return{dist:Math.sqrt(n*n+r*r),angle:Math.atan2(r,n)}}function i(){ot=t.getBoundingClientRect().width,at=ot}function s(t){var e=r(F,t);Y=e.x,z=e.y;var n=a(Y,z),i=n.dist,s=n.angle;return D>i?(F.style.cursor="pointer",Pt?(o(t),p()):xt=!0):F.style.cursor="default",f(!1),(St=Q.isPointInPath(Y,z))?(v(),d(!0),!1):(i>I-.5*gt&&I+.5*gt>i&&(lt=s*nt+90,0>lt&&(lt+=360),v(),d(!1),m()),!1)}function l(t){var e=r(F,t);Y=e.x,z=e.y;var n,o=a(Y,z),i=o.dist,s=o.angle;if(D>i&&(F.style.cursor="pointer"),St)lt=s*nt+90,0>lt&&(lt+=360),ut&&(0>i&&(i=0),i>I-H&&(i=I-H),dt=i/(I-H)),k(),v(),d(!0),m();else{if(f(!1),n=Q.isPointInPath(Y,z))return F.style.cursor="pointer",!1;if(i>I-.5*gt&&I+.5*gt>i)return F.style.cursor="crosshair",!1;if(D>i)return F.style.cursor="pointer",!1;F.style.cursor="default"}return!1}function h(t){var e=r(F,t);Y=e.x,z=e.y;var n=a(Y,z),i=n.dist;o(t),!Pt&&xt&&D>i?(F.style.cursor="pointer",p()):F.style.cursor="default",St=!1,xt=!1,g()}function c(){I=.5*(ot-gt-2*bt)+1,D=(I-.5*gt)*pt,K=[it-.5*gt,st],H=Math.max(ot*vt,5)}function u(){var n,r,o,a,i;for(c(),ot=t.getBoundingClientRect().width,Q.clearRect(0,0,ot,at),F.width=F.height=ot,F.innerHTML="<h1>No HTML5 Canvas support. Please upgrade the browser.</h1>",Q.lineWidth=gt,bt>0&&(Q.save(),Q.save(),Q.shadowColor=e.shadowColor||"rgba(0, 0, 0, 1)",Q.shadowBlur=bt,Q.beginPath(),Q.arc(it,st,I,0,rt),Q.closePath(),Q.stroke(),Q.restore(),Q.globalCompositeOperation="destination-out",Q.beginPath(),Q.arc(it,st,I,0,rt),Q.closePath(),Q.stroke(),Q.restore()),n=0,o=0,a=4/$;360>n;n+=$)r=(n-90+1)*et,i=n*a,Q.strokeStyle="rgb("+B[i]+","+B[i+1]+","+B[i+2]+")",Q.beginPath(),Q.arc(it,st,I,o,r+.01),Q.stroke(),o=r;F.style.backgroundImage="url("+F.toDataURL()+")",Q.clearRect(0,0,ot,at)}function d(t){f(!0),mt&&(Q.shadowColor=e.shadowColor||"rgba(0, 0, 0, 1)",Q.shadowBlur=bt),Q.lineWidth=ot/70,Q.strokeStyle="#000",Q.fillStyle="rgb("+A+","+G+","+O+")",Q.fill(),mt&&(Q.shadowColor="rgba(0, 0, 0, 0)",Q.shadowBlur=0),Q.stroke()}function f(t){Q.setTransform(1,0,0,1,0,0),Q.translate(it,st),Q.rotate((lt-90)*et),Q.translate(-it,-st);var e=it+H+(I-H)*(ut?dt:1);ut&&t&&(Q.lineWidth=1,Q.beginPath(),Q.moveTo(it,st-.5),Q.lineTo(it+I-.5*gt,st-.5),Q.strokeStyle="#000",Q.stroke(),Q.beginPath(),Q.moveTo(it,st+.5),Q.lineTo(it+I-.5*gt,st+.5),Q.strokeStyle="#fff",Q.stroke()),Q.beginPath(),Q.arc(e,st,.4*gt,0,rt),Q.closePath()}function g(){v(),d(!1)}function v(){b(),Q.clearRect(0,0,ot,at),ht&&(Q.beginPath(),Q.arc(it,st,D,0,rt),Q.closePath(),Q.fillStyle="rgb("+A+","+G+","+O+")",Q.fill(),Q.lineWidth=kt,Q.strokeStyle=Mt,Q.stroke())}function b(){var t=ct?y(lt,dt,ft):C(lt,dt,ft);A=t.r,G=t.g,O=t.b,k()}function m(){clearTimeout(X),null!==N.onchange&&(X=setTimeout(N.onchange({h:lt%360,s:dt,l:ft,v:ft,r:A,g:G,b:O,x:Y,y:z,isIE:_,isTouch:Pt}),12))}function p(){clearTimeout(X),null!==N.onclick&&(X=setTimeout(N.onclick({h:lt%360,s:dt,l:ft,v:ft,r:A,g:G,b:O,x:Y,y:z,isIE:_,isTouch:Pt}),12))}function k(){lt%=360,dt=Math.max(0,Math.min(dt,1)),ft=Math.max(0,Math.min(ft,1));var t=M(A,G,O);A=t.r,G=t.g,O=t.b}function M(t,e,n){return t=Math.max(0,Math.min(t,255)),e=Math.max(0,Math.min(e,255)),n=Math.max(0,Math.min(n,255)),{r:t,g:e,b:n}}function C(t,e,n){t/=60;var r,o=0|t,a=t-o,i=1-e,s=n*i,l=n*(i*a),h=n*(i*(1-a));switch(o){case 0:r=[n,h,s];break;case 1:r=[l,n,s];break;case 2:r=[s,n,h];break;case 3:r=[s,l,n];break;case 4:r=[h,s,n];break;case 5:case 6:r=[n,s,l]}return{r:255*r[0]+.5|0,g:255*r[1]+.5|0,b:255*r[2]+.5|0}}function y(t,e,n){function r(t,e,n){return n%=1,.166667>n?t+(e-t)*n*6:.5>n?e:.666667>n?t+(e-t)*(.666667-n)*6:t}var o,a,i,s,l;return t/=360,0===e?o=a=i=n:(s=.5>n?n*(1+e):n+e-n*e,l=2*n-s,o=r(l,s,t+.333333),a=r(l,s,t),i=r(l,s,t-.333333)),o=255*o+.5|0,a=255*a+.5|0,i=255*i+.5|0,o=Math.max(0,Math.min(o,255)),a=Math.max(0,Math.min(a,255)),i=Math.max(0,Math.min(i,255)),{r:o,g:a,b:i}}function w(t,e,n){t/=255,e/=255,n/=255;var r=Math.max(t,e,n),o=Math.min(t,e,n),a=r-o,i=0,s=0,l=.5*(r+o);return r!==o&&(s=.5>l?a/(r+o):a/(2-r-o),i=t===r?(e-n)/a:e===r?2+(n-t)/a:4+(t-e)/a),i*=60,0>i&&(i+=360),{h:i,s:s,l:l}}function S(t,e,n){t/=255,e/=255,n/=255;var r,o,a,i,s=Math.min(t,Math.min(e,n)),l=Math.max(t,Math.max(e,n));return s===l?(a=s,{h:0,s:0,v:a}):(i=t===s?e-n:n===s?t-e:n-t,r=t===s?3:n===s?1:5,r=60*(r-i/(l-s)),o=(l-s)/l,a=l,{h:r,s:o,v:a})}function P(t,e,n){lt=t,dt=e,ft=n,k(),g()}function E(t){return"string"==typeof t}function x(t){return"boolean"==typeof t}function L(t){return"number"==typeof t}function T(t){return"undefined"!=typeof t}e=e||{},E(t)&&(t=document.getElementById(t));var R,B,I,D,K,W,H,X,Y,z,A,G,O,U,j,q,N=this,_=navigator.msPointerEnabled,F=document.createElement("canvas"),J=document.createElement("canvas"),Q=F.getContext("2d"),V=J.getContext("2d"),Z=360,$=360/Z,tt=V.createLinearGradient(0,0,Z,0),et=(.5*Math.PI,Math.PI/180),nt=180/Math.PI,rt=2*Math.PI,ot=t.getBoundingClientRect().width,at=ot,it=.5*ot,st=it,lt=0,ht=!0,ct=!0,ut=!1,dt=1,ft=.5,gt=Math.max(.15*ot,3),vt=.1,bt=ot/40,mt=!0,pt=.9,kt=ot/15,Mt="#000",Ct="#fff",yt="#777",wt=!0,St=!1,Pt=!1;for(U=Object.keys(e),W=0;j=U[W];W++)switch(q=e[j],j){case"diameter":L(q)&&(ot=at=e.diameter),it=.5*ot,st=it;break;case"hue":L(q)&&(lt=q%360);break;case"colorSpace":!E(q)||"hsl"!==q&&"hsv"!==q||(ct="hsl"===q);break;case"saturation":L(q)&&(dt=q);break;case"lightness":case"brightness":L(q)&&(ft=q);break;case"thicknessHue":L(q)&&(gt=q);break;case"hueKnobSize":L(q)&&(vt=q);break;case"shadowBlur":L(q)&&(bt=q);break;case"hueKnobShadow":x(q)&&(mt=q);break;case"showColorSpot":x(q)&&(ht=q);break;case"tabable":x(q)&&(wt=q);break;case"colorSpotWidth":L(q)&&(pt=q);break;case"colorSpotBorder":L(q)&&(kt=q);break;case"colorSpotBorderColor":E(q)&&(Mt=q);break;case"hueKnobColor":E(q)&&(Ct=q);break;case"lightnessKnobColor":E(q)&&(lightKnobColor=q);break;case"hueKnobColorSelected":E(q)&&(yt=q);break;case"lightnessKnobColorSelected":E(q)&&(lightKnobColorSel=q);break;case"lightnessRingClickable":x(q)&&(lightClickable=q);break;case"rgb":if(Array.isArray(q)&&3===q.length){var Et=ct?w(q[0],q[1],q[2]):S(q[0],q[1],q[2]);lt=Et.h,dt=Et.s,ft=Et.l}}this.onchange=T(e.onChange)?e.onChange:null,this.onclick=T(e.onClick)?e.onClick:null,F.id=(t.id||"hueWheel")+"_canvas",wt&&(F.tabIndex=0),J.width=Z,J.height=2,tt.addColorStop(0,"#f00"),tt.addColorStop(.17,"#ff0"),tt.addColorStop(.33,"#0f0"),tt.addColorStop(.5,"#0ff"),tt.addColorStop(.67,"#00f"),tt.addColorStop(.83,"#f0f"),tt.addColorStop(1,"#f00"),V.fillStyle=tt,V.fillRect(0,0,Z,1),tt=V.createLinearGradient(0,0,Z,0),tt.addColorStop(0,"#000"),tt.addColorStop(1,"#fff"),V.fillStyle=tt,V.fillRect(0,1,Z,1),R=V.getImageData(0,0,Z,2),B=R.data,u(),t.innerHTML="",t.appendChild(F),g(),m();var xt=!1;_?(F.addEventListener("MSPointerDown",s,!1),window.addEventListener("MSPointerMove",l,!1),window.addEventListener("MSPointerUp",h,!1)):(F.addEventListener("mousedown",s,!1),window.addEventListener("mousemove",l,!1),window.addEventListener("mouseup",h,!1)),window.addEventListener("resize",i,!1),document.body.addEventListener("touchstart",function(t){t.target===F&&t.preventDefault()},!1),document.body.addEventListener("touchend",function(t){t.target===F&&t.preventDefault()},!1),document.body.addEventListener("touchmove",function(t){t.target===F&&t.preventDefault()},!1),F.addEventListener("touchstart",function(t){mousePos=n(F,t);var e=t.touches[0],r=new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY});F.dispatchEvent(r)},!1),F.addEventListener("touchend",function(t){var e=new MouseEvent("mouseup",{});F.dispatchEvent(e)},!1),F.addEventListener("touchmove",function(t){var e=t.touches[0],n=new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY});F.dispatchEvent(n)},!1),this.hsl=function(t,e,n){if(!arguments.length){if(ct)return{h:lt,s:dt,l:ft};var r=C(lt,dt,ft),o=w(r.r,r.g,r.b);return{h:o.h,s:o.s,l:o.l}}return P(t,e,n),this},this.hsv=function(t,e,n){var r,o,a;return arguments.length?(r=C(t,e,n),a=w(r.r,r.g,r.b),P(a.h,a.s,a.l),this):ct?(r=y(lt,dt,ft),o=S(r.r,r.g,r.b),{h:o.h,s:o.s,v:o.v}):{h:lt,s:dt,v:ft}},this.rgb=function(t,e,n){if(!arguments.length)return{h:lt,s:dt,l:ft,v:ft};var r=M(t,e,n);t=r.r,e=r.g,n=r.b;var o=ct?w(t,e,n):S(t,e,n);return lt=o.h,dt=o.s,ft=o.l||o.v,k(),g(),m(),this},this.showColor=function(t){return arguments.length&&x(t)?(ht=t,g(),this):ht},this.thicknessHue=function(t){return arguments.length&&L(t)?(3>t&&(t=3),t>.3*ot&&(t=.3*ot|0),gt=t,u(),g(),this):gt},this.colorSpotRadius=function(t){return arguments.length&&L(t)?(pt=t,u(),g(),this):pt},this.colorSpace=function(t){if(!arguments.length||"hsl"!==t&&"hsv"!==t)return ct?"hsl":"hsv";var e,n;return ct&&"hsv"===t?(e=y(lt,dt,ft),n=S(e.r,e.g,e.b),lt=n.h,dt=n.s,ft=n.v):ct||"hsl"!==t||(e=C(lt,dt,ft),n=w(e.r,e.g,e.b),lt=n.h,dt=n.s,ft=n.l),ct="hsl"===t,g(),m(),this},this.rgb2hsl=w,this.rgb2hsv=S,this.hsv2rgb=C,this.hsl2rgb=y}
